var mmw;(()=>{var e={60:()=>{document.addEventListener("keydown",(function(e){!e.ctrlKey||38!=e.keyCode&&40!=e.keyCode?setTimeout((function(){e.stopPropagation(),mmw.map.handlers.handleEvent(e)})):function(e){let t=mmw.map.getZoom();if(-1==e&&t<1)return;let o=.25*e;mmw.map.zoomTo(t+o)}(38==e.keyCode?-1:1)}))}},t={};function o(a){var r=t[a];if(void 0!==r)return r.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{"use strict";o.r(a),o.d(a,{_common:()=>ne,_control:()=>me,_custom:()=>pe,_layer:()=>se,_overlay:()=>ie,_router:()=>le,_view:()=>ce,map:()=>ve,marker:()=>he,markerpopup:()=>be,popup:()=>Se});var e={};o.r(e),o.d(e,{fetchData:()=>h,fetchJSON:()=>b,goHome:()=>y,loadScript:()=>w,params:()=>u,search:()=>g,setNav:()=>f,setType:()=>v});var t={};o.r(t),o.d(t,{bottombarEl:()=>_,collapse:()=>E,el:()=>M,headerEl:()=>x,loadInset:()=>k,makeCollapsible:()=>P,middleheaderEl:()=>L,rightbarEl:()=>C,rightheaderEl:()=>z});var r={};o.r(r),o.d(r,{initControls:()=>I});var n={};o.r(n),o.d(n,{addFillLayer:()=>T,addLineLayer:()=>N,addSymbolLayer:()=>O,enablePopup:()=>j});var i={};o.r(i),o.d(i,{moveObject:()=>K,objects:()=>H});var m={};o.r(m),o.d(m,{MAP_BASE:()=>Y,loadMapScript:()=>V,mapId:()=>q,navId:()=>Q});var s={};o.r(s),o.d(s,{loadSources:()=>ae});var l=[{id:"sat-layer",type:"raster",source:"sat-tiles"}];const p=protomaps_themes_base.default("protomaps","dark");p.splice(0,12),p.splice(2,1),p.splice(14,1);var c=[...l,...p],d={id:"MMW",version:8,name:"Map My World",center:[0,0],zoom:0,glyphs:"https://cdn.protomaps.com/fonts/pbf/{fontstack}/{range}.pbf",sources:{"raster-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,minzoom:2,maxzoom:19,attribution:'Â© Tiles <a href="https://openstreetmap.org">OpenStreetMap</a>'},"sat-tiles":{type:"raster",tiles:["https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:256,minzoom:2,maxzoom:19,attribution:'<a href="https://www.arcgis.com/index.html">Esri ArcGIS</a>'},protomaps:{type:"vector",minzoom:2,maxzoom:19,attribution:'Powered by <a href="https://protomaps.com">Protomaps</a>'},terrainSource:{type:"raster-dem",tiles:['https://api.ellipsis-drive.com/v3/path/085f5e10-63b6-4e8f-a4c6-dce9689100d3/raster/timestamp/3179fa80-60ad-41c7-ae67-cdd5eeeca693/tile/{z}/{x}/{y}?style={"method":"terrainRgb", "parameters":{"alpha":1, "bandNumber":1} }'],tileSize:256}}};o(60);const u=new URLSearchParams(document.location.search);function y(){window.location.href=window.location.origin+window.location.pathname}function g(e,t){u.set(e,t),window.location.search="?"+u.toString()}function f(e){g("nav",e)}function v(e){g("type",e)}function w(e){var t=document.createElement("script");t.src=e,document.body.append(t)}async function h(e){let t=await fetch(e);return await t.text()}async function b(e){var t=await h(e);return JSON.parse(t)}var S,x=M("header"),L=M("middleheader"),z=M("rightheader"),C=M("rightbar"),_=M("bottombar");function M(e){return document.getElementById(e)}function P(e){e.addEventListener("click",(function(){this.classList.toggle("active");var e=this.nextElementSibling;"none"===e.style.display?e.style.display="block":e.style.display="none"}))}function E(e){e.classList.toggle("active"),e.nextElementSibling.style.display="none"}function k(e){return S||((S=document.createElement("iframe")).classList="top right mmw-overlay mmw-overlay-group inset",document.body.append(S)),S.src=e,S}function I(){mmw.map.addControl(new maplibregl.NavigationControl({showCompass:!1}),"bottom-left"),mmw.map.addControl(new maplibregl.NavigationControl({visualizePitch:!0,showZoom:!1}),"bottom-left"),mmw.map.addControl(new maplibregl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"bottom-left"),mmw.map.addControl(new maplibregl.TerrainControl({source:"terrainSource",exaggeration:1}),"top-left")}function O(e,t,o,a){var r=newSymbolLayer(e,t,o);mmw.map.addLayer(r),a&&j(e,a)}function j(e,t){var o=e+"-symbols";mmw.map.on("mouseenter",o,(e=>{mmw.map.getCanvas().style.cursor="pointer";const o=t(e);if(o){const t=e.features[0].geometry.coordinates.slice();for(;Math.abs(e.lngLat.lng-t[0])>180;)t[0]+=e.lngLat.lng>t[0]?360:-360;mmw.popup.setLngLat(t).setHTML(o).addTo(map)}})),mmw.map.on("mouseleave",o,(()=>{mmw.map.getCanvas().style.cursor="",mmw.popup.remove()}))}function T(e,t,o,a){var r,n=e+"-fills",i=newFillLayer(e,t,o,a);a&&(mmw.map.on("mousemove",n,(t=>{t.features.length>0&&(r&&mmw.map.setFeatureState({source:e,id:r},{hover:!1}),r=t.features[0].id,mmw.map.setFeatureState({source:e,id:r},{hover:!0}))})),mmw.map.on("mouseleave",n,(()=>{r&&mmw.map.setFeatureState({source:e,id:r},{hover:!1})}))),mmw.map.addLayer(i)}function N(e,t,o){var a=newLineLayer(e,t,o);mmw.map.addLayer(a)}var A,F,B,J,R,Z,D,G,H={},W=1,U=50;function K(){if(routes&&-1!=B){null==B&&(B=routes.length-1,J=0),F=routes[B];var e=H[F.properties.object];if(e&&(A!=e&&(A?scene3js.remove(A.scene):D||X(),A=e,F.properties.direction&&(A.scene.rotation.y=F.properties.direction*Math.PI/180),map.flyTo({center:geoJSONData[2].features[B].geometry.coordinates,zoom:F.properties.zoom||zoom,pitch}),scene3js.add(A.scene)),B>=0))if(W<U)def_transform.translateX=D.x,def_transform.translateY=D.y,D.x=D.x+G.x,D.y=D.y+G.y,W+=1;else{if(W=1,(J+=1)==F.geometry.coordinates.length-1){if(-1==(B-=1))return;F=routes[B],J=0,map.flyTo({center:geoJSONData[2].features[B].geometry.coordinates,zoom,pitch})}X()}}}function X(){R=maplibregl.MercatorCoordinate.fromLngLat(F.geometry.coordinates[J],0),Z=maplibregl.MercatorCoordinate.fromLngLat(F.geometry.coordinates[J+1],0),D=R,U=F.properties.steps||50,G={x:(Z.x-R.x)/U,y:(Z.y-R.y)/U}}var Y="/maps/",q=u.get("id"),Q=u.get("nav");function V(e){w(Y+e+"/"+e+".js")}q&&V(q);let $=u.get("src"),ee=u.get("view"),te=u.get("type"),oe="pin";function ae(){$&&("inset"!=ee?("basic"==te?mmw.map.setZoom(16.5):mmw.map.setZoom(15.99),mmw.map.setPitch(60)):oe="pin-xs",mmw.map.loaded()?re($):mmw.map.on("load",(function(){re($)})))}async function re(e){var t,o;e=e.split(",");for(let o=0;o<e.length;o++){var a=e[o];if(a){var r=await b(a);(t=r.features[0])&&(mmw.map.addSource("source-"+o,{type:"geojson",data:r}),t.properties.height?mmw.map.addLayer(newExtrusionLayer("source-"+o)):(T("source-"+o,"",.5,.2),N("source-"+o,"",2)),O("source-"+o,oe,["get","name"]))}}"Polygon"==t.geometry.type&&(o=t.geometry.coordinates[0][0],mmw.map.flyTo({center:o}))}const ne=e,ie=t,me=r,se=n,le=i,pe=m,ce=s;let de=u.get("z")||3.5,ue=u.get("lat")||22,ye=u.get("lng")||80,ge=u.get("type");var fe=d;"basic"===ge?d.layers=[{id:"basic-layer",type:"raster",source:"raster-tiles"}]:"satellite"===ge?d.layers=l:"hybrid"===ge?d.layers=c:"none"===ge?d.layers=[]:"demo"==ge?fe="https://demotiles.maplibre.org/style.json":v("basic");const ve=new maplibregl.Map({container:"map",hash:!0,style:fe,center:[ye,ue],zoom:de,pitch:0,bearing:0,antialias:!0,maxPitch:85}),we=ve._controls[0];ve.removeControl(we),ve.addControl(we,"bottom-left"),ve.on("load",(()=>{we._compact=!0,we._updateCompact(),we._updateCompactMinimize()})),ve.loadImage("img/pin-sm.png",((e,t)=>{ve.addImage("pin",t),ve.addImage("pin-xs",t,{pixelRatio:2})})),ve.loadImage("img/pin-blue-sm.png",((e,t)=>{ve.addImage("pin-blue",t),ve.addImage("pin-blue-xs",t,{pixelRatio:2})}));const he=new maplibregl.Marker,be=new maplibregl.Popup({closeButton:!1});he.setPopup(be);const Se=new maplibregl.Popup({closeButton:!1,closeOnClick:!1})})(),mmw=a})();