var mmw;(()=>{"use strict";var e={d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{_base:()=>Le,_common:()=>_e,_comp:()=>Ee,_control:()=>Ce,_custom:()=>ke,_event:()=>Se,_layer:()=>Me,_overlay:()=>xe,_router:()=>ze,_view:()=>Te,map:()=>Ae,marker:()=>He,markerpopup:()=>Be,popup:()=>Re});var a={};e.r(a),e.d(a,{bas_layers:()=>d,hyb_layers:()=>f,light_protomap_layers:()=>y,sat_layers:()=>u,style:()=>b});var o={};e.r(o),e.d(o,{onCountrySelect:()=>v});var r={};e.r(r),e.d(r,{fetchData:()=>C,fetchJSON:()=>E,goHome:()=>h,loadScript:()=>x,params:()=>w,search:()=>L,setNav:()=>S,setType:()=>_});var n={};e.r(n),e.d(n,{bottombarEl:()=>I,collapse:()=>N,el:()=>j,headerEl:()=>z,loadInset:()=>A,makeCollapsible:()=>O,middleheaderEl:()=>k,rightbarEl:()=>P,rightheaderEl:()=>T});var i={};e.r(i),e.d(i,{initControls:()=>F,initTerrain:()=>H});var m={};e.r(m),e.d(m,{createTab:()=>B,createTablink:()=>J,switchTab:()=>R});var s={};e.r(s),e.d(s,{addBubbleLayer:()=>K,addCircleLayer:()=>q,addExtrusionLayer:()=>W,addFillLayer:()=>G,addHeatmapLayer:()=>X,addHexagonLayer:()=>Y,addLineLayer:()=>U,addSymbolLayer:()=>Z,enablePopup:()=>D,highlightCountries:()=>Q});var l={};e.r(l),e.d(l,{moveObject:()=>le,objects:()=>ie});var c={};e.r(c),e.d(c,{MAP_BASE:()=>pe,loadMapScript:()=>ye,mapId:()=>de,navId:()=>ue});var p={};e.r(p),e.d(p,{loadSources:()=>we});var d=[{id:"basic-layer",type:"raster",source:"raster-tiles"}],u=[{id:"sat-layer",type:"raster",source:"sat-tiles"}];const y=protomaps_themes_base.default("protomaps","light"),g=protomaps_themes_base.default("protomaps","dark");g.splice(0,12),g.splice(2,1),g.splice(14,1);var f=[...u,...g],b={id:"MMW",version:8,name:"Map My World",center:[0,0],zoom:0,glyphs:"https://cdn.protomaps.com/fonts/pbf/{fontstack}/{range}.pbf",sources:{"raster-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,minzoom:1,attribution:'Â© Tiles <a href="https://openstreetmap.org">OpenStreetMap</a>'},"sat-tiles":{type:"raster",tiles:["https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:256,minzoom:1,attribution:'<a href="https://www.arcgis.com/index.html">Esri ArcGIS</a>'},protomaps:{type:"vector",tiles:["https://api.protomaps.com/tiles/v2/{z}/{x}/{y}.pbf?key=5b66dedf4564f2ac"],minzoom:1,attribution:'Powered by <a href="https://protomaps.com">Protomaps</a>'},terrainSource:{type:"raster-dem",tiles:['https://api.ellipsis-drive.com/v3/path/085f5e10-63b6-4e8f-a4c6-dce9689100d3/raster/timestamp/3179fa80-60ad-41c7-ae67-cdd5eeeca693/tile/{z}/{x}/{y}?style={"method":"terrainRgb", "parameters":{"alpha":1, "bandNumber":1} }'],tileSize:256}}};function v(e,t){function a(a){const o=map.queryRenderedFeatures(a.point),r=o[o.length-1];if(e&&r){var n=turf.center(r);map.flyTo({center:n.geometry.coordinates})}t(a,r)}mmw.map.on("click",a),mmw.map.on("touchstart","countries",a)}document.getElementById("map").addEventListener("keydown",(function(e){!e.ctrlKey||38!=e.keyCode&&40!=e.keyCode?setTimeout((function(){e.stopPropagation(),mmw.map.handlers.handleEvent(e)})):function(e){let t=mmw.map.getZoom();if(-1==e&&t<1)return;let a=.25*e;mmw.map.zoomTo(t+a)}(38==e.keyCode?-1:1)}));const w=new URLSearchParams(document.location.search);function h(){window.location.href=window.location.origin+window.location.pathname}function L(e,t){w.set(e,t),window.location.search="?"+w.toString()}function S(e){L("nav",e)}function _(e){L("type",e)}function x(e){var t=document.createElement("script");t.src=e,document.body.append(t)}async function C(e){let t=await fetch(e);return await t.text()}async function E(e){var t=await C(e);return JSON.parse(t)}var M,z=j("header"),k=j("middleheader"),T=j("rightheader"),P=j("rightbar"),I=j("bottombar");function j(e){return document.getElementById(e)}function O(e){e.addEventListener("click",(function(){this.classList.toggle("active");var e=this.nextElementSibling;"none"===e.style.display?e.style.display="block":e.style.display="none"}))}function N(e){e.classList.toggle("active"),e.nextElementSibling.style.display="none"}function A(e){return M||((M=document.createElement("iframe")).classList="top right mmw-overlay mmw-overlay-group inset",document.body.append(M)),M.src=e,M}function F(){mmw.map.addControl(new maplibregl.NavigationControl({showCompass:!1}),"bottom-left"),mmw.map.addControl(new maplibregl.NavigationControl({visualizePitch:!0,showZoom:!1}),"bottom-left"),mmw.map.addControl(new maplibregl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"bottom-left")}function H(){mmw.map.addControl(new maplibregl.TerrainControl({source:"terrainSource",exaggeration:1}),"top-left")}function B(){var e=document.createElement("div");return e.classList.add("tab"),e.setAttribute("onclick","mmw._comp.switchTab(this)"),e}function R(e,t){for(var a=e.children,o=0;o<a.length;o++)a[o].classList.remove("active");(null==t?event.target:a[t]).classList.add("active")}function J(e){var t=document.createElement("span");return t.classList.add("tablink"),t.innerHTML=e,t}function Z(e,t,a,o){var r=newSymbolLayer(e,t,a);if(1==map.getSource(e)._options.cluster){var n=newCircleLayer(e,15,"#51bbd6"),i=newSymbolLayer(e,"","{point_count_abbreviated}");i.id="nearby-count",delete i.layout["text-offset"],n.filter=i.filter=["has","point_count"],r.filter=["!",n.filter],map.addLayer(n),map.addLayer(i)}mmw.map.addLayer(r),o&&D(e,o)}function D(e,t){var a=e+"-symbols";mmw.map.on("mouseenter",a,(e=>{mmw.map.getCanvas().style.cursor="pointer";const a=t(e);if(a){const t=e.features[0].geometry.coordinates.slice();for(;Math.abs(e.lngLat.lng-t[0])>180;)t[0]+=e.lngLat.lng>t[0]?360:-360;mmw.popup.setLngLat(t).setHTML(a).addTo(map)}})),mmw.map.on("mouseleave",a,(()=>{mmw.map.getCanvas().style.cursor="",mmw.popup.remove()}))}function G(e,t,a,o){var r,n=e+"-fills",i=newFillLayer(e,t,a,o);o&&(mmw.map.on("mousemove",n,(t=>{t.features.length>0&&(r&&mmw.map.setFeatureState({source:e,id:r},{hover:!1}),r=t.features[0].id,mmw.map.setFeatureState({source:e,id:r},{hover:!0}))})),mmw.map.on("mouseleave",n,(()=>{r&&mmw.map.setFeatureState({source:e,id:r},{hover:!1})}))),mmw.map.addLayer(i)}function W(e,t,a,o){var r=newExtrusionLayer(e,t,a,o);mmw.map.addLayer(r)}function U(e,t,a){var o=newLineLayer(e,t,a);mmw.map.addLayer(o)}function q(e,t,a){var o=newCircleLayer(e,t,a);mmw.map.addLayer(o)}function K(e,t){var a=newBubbleLayer(e,t);mmw.map.addLayer(a)}function X(e,t){var a=newHeatmapLayer(e,t);mmw.map.addLayer(a)}function Y(e,t,a,o){var r=newHexagonLayer(e,t,a,o);mmw.map.addLayer(r,mmw.map.style._layers.pois?"pois":void 0)}function Q(e){e.length>1?mmw.map.setFilter("countries-boundary",["any",["==","NAME",e[0]],["==","NAME",e[1]]]):mmw.map.setFilter("countries-boundary",["==","NAME",e[0]])}var V,$,ee,te,ae,oe,re,ne,ie={},me=1,se=50;function le(){if(routes&&-1!=ee){null==ee&&(ee=routes.length-1,te=0),$=routes[ee];var e=ie[$.properties.object];if(e&&(V!=e&&(V?scene3js.remove(V.scene):re||ce(),V=e,$.properties.direction&&(V.scene.rotation.y=$.properties.direction*Math.PI/180),map.flyTo({center:geoJSONData[2].features[ee].geometry.coordinates,zoom:$.properties.zoom||zoom,pitch}),scene3js.add(V.scene)),ee>=0))if(me<se)def_transform.translateX=re.x,def_transform.translateY=re.y,re.x=re.x+ne.x,re.y=re.y+ne.y,me+=1;else{if(me=1,(te+=1)==$.geometry.coordinates.length-1){if(-1==(ee-=1))return;$=routes[ee],te=0,map.flyTo({center:geoJSONData[2].features[ee].geometry.coordinates,zoom,pitch})}ce()}}}function ce(){ae=maplibregl.MercatorCoordinate.fromLngLat($.geometry.coordinates[te],0),oe=maplibregl.MercatorCoordinate.fromLngLat($.geometry.coordinates[te+1],0),re=ae,se=$.properties.steps||50,ne={x:(oe.x-ae.x)/se,y:(oe.y-ae.y)/se}}var pe="/maps/",de=w.get("id"),ue=w.get("nav");function ye(e){x(pe+e+"/"+e+".js"),x("/"+e+"/"+e+".js")}de&&ye(de);let ge=w.get("src"),fe=w.get("view"),be=w.get("type"),ve="pin";function we(){ge&&("inset"!=fe?("basic"==be?mmw.map.setZoom(16.5):mmw.map.setZoom(15.99),mmw.map.setPitch(60)):ve="pin-xs",mmw.map.loaded()?he(ge):mmw.map.on("load",(function(){he(ge)})))}async function he(e){var t,a;e=e.split(",");for(let a=0;a<e.length;a++){var o=e[a];if(o){var r=await E(o);(t=r.features[0])&&(mmw.map.addSource("source-"+a,{type:"geojson",data:r}),t.properties.height?mmw.map.addLayer(newExtrusionLayer("source-"+a)):(G("source-"+a,"",.5,.2),U("source-"+a,"",2)),Z("source-"+a,ve,["get","name"]))}}"Polygon"==t.geometry.type&&(a=t.geometry.coordinates[0][0],mmw.map.flyTo({center:a}))}const Le=a,Se=o,_e=r,xe=n,Ce=i,Ee=m,Me=s,ze=l,ke=c,Te=p;let Pe=w.get("z")||3.5,Ie=w.get("lat")||22.22,je=w.get("lng")||80,Oe=w.get("type");var Ne=b;"basic"===Oe?b.layers=d:"satellite"===Oe?b.layers=u:"vector"===Oe?b.layers=y:"hybrid"===Oe?b.layers=f:"none"===Oe?b.layers=[]:"demo"==Oe?Ne="https://demotiles.maplibre.org/style.json":_("basic");const Ae=new maplibregl.Map({container:"map",hash:!0,style:Ne,center:[je,Ie],zoom:Pe,pitch:0,bearing:0,antialias:!0,maxPitch:85}),Fe=Ae._controls[0];Ae.removeControl(Fe),Ae.addControl(Fe,"bottom-left"),Ae.on("load",(()=>{Fe._compact=!0,Fe._updateCompact(),Fe._updateCompactMinimize()})),Ae.loadImage("img/pin-sm.png",((e,t)=>{Ae.addImage("pin",t),Ae.addImage("pin-xs",t,{pixelRatio:2})})),Ae.loadImage("img/pin-blue-sm.png",((e,t)=>{Ae.addImage("pin-blue",t),Ae.addImage("pin-blue-xs",t,{pixelRatio:2})}));const He=new maplibregl.Marker,Be=new maplibregl.Popup({closeButton:!1});He.setPopup(Be);const Re=new maplibregl.Popup({closeButton:!1,closeOnClick:!1});mmw=t})();